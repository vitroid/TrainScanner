#!/bin/bash

# post-commitフック: コミット後にバージョンタグを作成

echo "post-commitフック実行中..."

# 現在のバージョンを取得
CURRENT_VERSION=$(poetry version -s)
echo "現在のバージョン: $CURRENT_VERSION"

# バージョンタグを作成
TAG_NAME="v$CURRENT_VERSION"
echo "タグ $TAG_NAME を作成中..."

# 既存のタグがあるかチェック
if git tag -l | grep -q "^$TAG_NAME$"; then
    echo "タグ $TAG_NAME は既に存在します"
else
    git tag -a "$TAG_NAME" -m "Release version $CURRENT_VERSION"
    echo "タグ $TAG_NAME が作成されました"
fi

echo "post-commitフック完了" 